
@{
    ViewBag.Title = "ResetPassWord";
    Layout = "~/Views/Shared/_LayoutAgentV2.cshtml";
}

<div class="modal-dialog" role="document">
    <div class="modal-content form-horizontal">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="关闭"><span aria-hidden="true">×</span></button>
            <h4 class="modal-title" id="myModalLabel">修改密码</h4>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="old_password" class="col-sm-3 control-label">原登录密码</label>
                <div class="col-sm-6">
                    <input type="password" class="form-control" id="old_password" name="old_password" value="" placeholder="请输入原登录密码">
                </div>
            </div>
            <div class="form-group">
                <label for="password" class="col-sm-3 control-label">新登录密码</label>
                <div class="col-sm-6">
                    <input type="password" class="form-control" id="password" name="password" value="" placeholder="请输入新登录密码">
                </div>
            </div>
            <div class="form-group">
                <label for="password_confirm" class="col-sm-3 control-label">确认新登录密码</label>
                <div class="col-sm-6">
                    <input type="password" class="form-control" id="password_confirm" name="password_confirm" value="" placeholder="请确认新登录密码">
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" onclick="updatePwd()" class="btn btn-primary">保存</button>
        </div>
    </div>
</div>

<script>
    function updatePwd() {
        var oldPwd = $("#old_password").val().trim();
        var newPwd = $("#password").val().trim();
        var confirmPwd = $("#password_confirm").val().trim();
        if (newPwd !== confirmPwd) {
            layer.msg("两次新密码不一致");
            return;
        }
        if (oldPwd.length < 6 || newPwd.length < 6 || confirmPwd.length < 6) {
            layer.msg("请输入大于6位的密码");
            return;
        }
        $core.ajax.getJSON("/Home/UpdatePassWord", { oldPwd: oldPwd, newPwd: newPwd }, function (data) {
            if (data === 1) {
                layer.msg("修改成功");
                $("#etop-modal").modal("hide");
            } else if (data === 0) {
                layer.msg("修改失败");
            } else if (data === 2) {
                layer.msg("原始密码错误");
            } else {
                layer.msg(this.message);
            }
        });
    }
</script>