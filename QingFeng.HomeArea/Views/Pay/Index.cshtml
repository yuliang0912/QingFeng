@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAgentV2.cshtml";
}
@using QingFeng.Common
@using QingFeng.Common.ApiCore.Result
@model ApiPageList<QingFeng.Models.PayOrder>

<style type="text/css">
    table tbody td {
        text-align: center;
        vertical-align: middle !important;
    }
</style>

<div class="page-header" id="payment-filter">
    <h1 class="form-inline">
        &nbsp;支付流水单 <small>
            <i class="icon-search"></i> 筛选:
            <div class="form-group">
                <label class="sr-only" for="order-sn">关键字</label>
                <input type="number" name="order_sn" id="order-sn" style="width: 220px;" value="@(ViewBag.keyWords)" class="form-control input-sm" placeholder="输入订单号或流水号">
            </div>
            <div class="form-group">
                <label class="sr-only" for="pay_status">支付状态</label>
                <select name="pay_status" id="pay_status" class="form-control input-sm filter_goods">
                    <option value="99" selected="selected">支付状态</option>
                    @foreach (var item in Enum.GetValues(typeof(AgentEnums.PayStatus)))
                    {
                        <option value="@item.GetHashCode()" @(ViewBag.payStatus == item.GetHashCode() ? "selected" : "")>
                            @item.ToString()
                        </option>
                    }
                </select>
            </div>
            <button type="button" class="btn btn-primary btn-sm " id="do-payment-filter">过滤</button>
        </small>
    </h1>
</div>

<!-- /.page-header -->
<!-- PAGE CONTENT BEGINS -->
<div class="table-responsive">
    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th class="center">支付流水号</th>
                <th class="center">支付方式</th>
                <th class="center">支付金额</th>
                <th class="center">交易手续费</th>
                <th class="center">状态</th>
                <th class="center">支付时间</th>
                <th class="center">审核状态</th>
                <th class="center">操作</th>
            </tr>
        </thead>

        <tbody>
            @foreach (var item in Model.PageList)
            {
                <tr align="center">
                    <td>@item.PayNo</td>
                    <td>@item.PayType.ToString() </td>
                    <td>@item.ActualPrice</td>
                    <td>@item.CounterFee</td>
                    <td><span class="label  @(item.PayStatus == AgentEnums.PayStatus.支付成功 ? "label-success":"label-warning" )">@item.PayStatus.ToString()</span></td>
                    <td>@item.PayDate</td>
                    <td><span class="label  @(item.VerifyStatus == AgentEnums.VerifyStatus.已审核 ? "label-success":"label-warning")">@item.VerifyStatus.ToString()</span></td>
                    <td>
                        <a href="http://www.findshoes.cn/payment/detail/651" title="查看支付详情" class="btn btn-info btn-sm load-content"> 详情</a>
                    </td>
                </tr>
            }
        </tbody>
       @if (Model.PageCount > 1)
       {
        <tfoot>
            <tr align="center">
                <td colspan="8">
                    @(Html.Raw(Model.GetPagerHtml(string.Format("/pay/index?keyWords={0}&payStatus={1}&page={2}", ViewBag.keyWords, ViewBag.payStatus, "{0}"))))
                </td>
            </tr>
        </tfoot>
       }
    </table>
</div>
<!-- /.table-responsive -->
<!-- PAGE CONTENT ENDS -->
<script type="text/javascript">
    $(function () {
        $('#do-payment-filter').click(function () {

            var order_sn = $('#order-sn').val();
            var pay_status = $('#pay_status').val();

            var base_url = 'http://www.qingfeng.com/pay/index';
            var params = '?keyWords=' + order_sn + '&payStatus=' + pay_status;

            url = base_url + params;
            $.getPageContent({ url: url });
        });
    });
</script>
